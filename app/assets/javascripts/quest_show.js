function limitdate (limitstr){
  var limit = new Date(limitstr);
  var resttime = Math.max((limit.getTime() - Date.now()) / 1000, 0);

  var str = "残り " +
                ('00' + Math.floor(resttime/60/60)).slice(-2) + ":" +
                ('00' + Math.floor(resttime/60%60)).slice(-2) + ":" +
                ('00' + Math.floor(resttime%60%60)).slice(-2);
  return str;
};

$( function(){
  $(".progressbar").each(function () {
    $(this).attr('width', $(this).parent().width())
    $(this)
    .drawRect({
        layer: true,
        fillStyle: '#000',
        shadowColor: '#333',
        shadowBlur: 5,
        x: 10, y: 5,
        width: $(this).width() - 20,
        height: 30,
        mask: true
      });
    $(this)
    .drawRect({
        layer: true,
        name: 'bar',
        fillStyle: '#E8BC23',
        shadowColor: '#333',
        shadowBlur: 5,
        x: 5,
        y: 5,
        width: 0,
        height: 30
      });
  })
});
